# Spring Cloud Learning Framework
## E-commerce Marketplace Implementation

> **Business Context**: Building "ShopHub" - a multi-vendor e-commerce marketplace with separate services for users, products, orders, payments, notifications, and vendor management.

---

## ğŸ¯ Learning Objectives
By the end of this framework, you'll build a production-ready microservices architecture using Spring Cloud to handle:
- **100k+ products** across multiple vendors
- **High-traffic scenarios** (Black Friday, flash sales)
- **Multi-region deployments**
- **Real-time inventory updates**
- **Payment processing workflows**

---

## ğŸ“‹ Prerequisites Checklist
- [ ] Java 17+ installed
- [ ] Spring Boot 3.x experience
- [ ] Docker & Docker Compose
- [ ] Maven/Gradle familiarity
- [ ] Basic REST API knowledge
- [ ] Git version control

---

## ğŸ—ºï¸ Learning Path (8-Week Plan)

### **Week 1-2: Foundation & Service Discovery**
**Spring Cloud Components**: Eureka Server, Eureka Client

**Business Scenario**: Setting up core services that need to find each other dynamically

**Hands-on Project**: 
- Create Eureka Server (Service Registry)
- Build 3 core services:
  - `user-service` (user management, authentication)
  - `product-service` (product catalog, search)
  - `order-service` (order processing, cart management)

**Specific Tasks**:
- [x] Set up Eureka Server on port 8761
- [x] Register all services with Eureka
- [x] Implement health checks for each service
- [x] Create service-to-service communication (user-service â†’ product-service)
- [x] Test service discovery with multiple instances

**âœ… å®ç°å®Œæˆè¯¦æƒ…**:

### ğŸ¢ Eureka Server é…ç½®
- **ç«¯å£**: 8761
- **åŠŸèƒ½**: æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œæä¾›æœåŠ¡å‘ç°èƒ½åŠ›
- **é…ç½®äº®ç‚¹**: 
  - å¼€å‘ç¯å¢ƒå…³é—­è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ï¼Œä¾¿äºæµ‹è¯•
  - è‡ªå®šä¹‰æ¸…ç†é—´éš”æ—¶é—´ (5ç§’)
  - è¯¦ç»†çš„å¥åº·æ£€æŸ¥å’Œæ—¥å¿—é…ç½®
- **è®¿é—®åœ°å€**: http://localhost:8761

### ğŸ”— æœåŠ¡æ³¨å†Œé…ç½®
æ‰€æœ‰å¾®æœåŠ¡éƒ½æˆåŠŸæ³¨å†Œåˆ° Eurekaï¼š

**ğŸ‘¥ User Service (ç«¯å£ 8081)**:
- âœ… @EnableDiscoveryClient + @EnableFeignClients
- âœ… H2å†…å­˜æ•°æ®åº“ï¼Œå¸¦ç”¨æˆ·ç®¡ç†åŠŸèƒ½
- âœ… å®Œæ•´çš„ RESTful API (CRUDæ“ä½œ)
- âœ… Feignå®¢æˆ·ç«¯è°ƒç”¨äº§å“æœåŠ¡

**ğŸ“¦ Product Service (ç«¯å£ 8082)**:
- âœ… @EnableDiscoveryClient 
- âœ… äº§å“ç›®å½•ç®¡ç†ï¼Œæ”¯æŒæœç´¢å’Œç­›é€‰
- âœ… æ¨¡æ‹Ÿ5ä¸ªäº§å“æ•°æ® (Appleã€Samsungã€Lenovoç­‰)
- âœ… æœåŠ¡é—´é€šä¿¡æ¥å£ (/api/products/{id}/exists)

**ğŸ“‹ Order Service (ç«¯å£ 8083)**:
- âœ… @EnableDiscoveryClient + @EnableFeignClients
- âœ… è®¢å•ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒçŠ¶æ€è·Ÿè¸ª
- âœ… è®¢å•ç»Ÿè®¡åŠŸèƒ½å’ŒæŠ¥è¡¨æ¥å£
- âœ… æ¨¡æ‹Ÿè®¢å•æ•°æ®ï¼ŒåŒ…å«å¤šç§çŠ¶æ€

### ğŸ¥ å¥åº·æ£€æŸ¥å®ç°
- **Spring Boot Actuator**: æ‰€æœ‰æœåŠ¡å¯ç”¨å¥åº·æ£€æŸ¥ç«¯ç‚¹
- **ç›‘æ§ç«¯ç‚¹**: `/actuator/health`, `/actuator/info`, `/actuator/metrics`
- **è¯¦ç»†çŠ¶æ€**: æ˜¾ç¤ºæ•°æ®åº“è¿æ¥ã€Eurekaæ³¨å†ŒçŠ¶æ€ç­‰
- **è‡ªå®šä¹‰å¥åº·æ£€æŸ¥**: å„æœåŠ¡æä¾›ä¸šåŠ¡å±‚é¢çš„å¥åº·çŠ¶æ€

### ğŸ”„ æœåŠ¡é—´é€šä¿¡
**é€šä¿¡æ¨¡å¼**: User Service â†’ Product Service
- **æŠ€æœ¯**: Spring Cloud OpenFeign
- **æ¥å£**: `/api/users/check-product/{productId}`
- **åŠŸèƒ½**: ç”¨æˆ·æœåŠ¡è°ƒç”¨äº§å“æœåŠ¡éªŒè¯äº§å“å­˜åœ¨æ€§
- **å®¹é”™**: åŒ…å«å¼‚å¸¸å¤„ç†ï¼ŒæœåŠ¡ä¸å¯ç”¨æ—¶ä¼˜é›…é™çº§

### ğŸ§ª æµ‹è¯•éªŒè¯
åˆ›å»ºäº†è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬ `test-service-discovery.sh`:
- âœ… æœåŠ¡å¯åŠ¨çŠ¶æ€æ£€æŸ¥
- âœ… å¥åº·æ£€æŸ¥éªŒè¯
- âœ… Eurekaæ³¨å†ŒçŠ¶æ€ç¡®è®¤  
- âœ… æœåŠ¡é—´é€šä¿¡æµ‹è¯•
- âœ… APIåŠŸèƒ½å®Œæ•´æ€§æµ‹è¯•
- âœ… æœåŠ¡ç»Ÿè®¡ä¿¡æ¯å±•ç¤º

**è¿è¡Œæµ‹è¯•**:
```bash
./test-service-discovery.sh
```

### ğŸ“Š æ ¸å¿ƒæŒ‡æ ‡
- **æ³¨å†ŒæœåŠ¡æ•°**: 3ä¸ª (user-service, product-service, order-service)
- **æœåŠ¡å‘ç°æ—¶é—´**: < 30ç§’
- **å¥åº·æ£€æŸ¥é¢‘ç‡**: æ¯10ç§’
- **æœåŠ¡ä¸‹çº¿æ£€æµ‹**: 30ç§’è¶…æ—¶
- **æ¨¡æ‹Ÿæ•°æ®**: ç”¨æˆ·ã€äº§å“ã€è®¢å•å®Œæ•´ä¸šåŠ¡æ•°æ®

**Real-world Learning**: æ¨¡æ‹Ÿä¾›åº”å•†å…¥é©»åœºæ™¯ï¼Œæ–°çš„äº§å“æœåŠ¡è‡ªåŠ¨æ³¨å†Œå¹¶å¯è¢«å…¶ä»–æœåŠ¡å‘ç°å’Œè°ƒç”¨

---

### **Week 3: API Gateway & Routing**
**Spring Cloud Components**: Spring Cloud Gateway

**Business Scenario**: Single entry point for mobile app, web frontend, and partner APIs

**Hands-on Project**:
- Implement API Gateway as the single entry point
- Route requests to appropriate microservices
- Add rate limiting for different user tiers (premium vs. regular customers)

**Specific Tasks**:
- [x] Set up Spring Cloud Gateway on port 8080
- [x] Configure routing rules:
  - `/api/users/**` â†’ user-service
  - `/api/products/**` â†’ product-service  
  - `/api/orders/**` â†’ order-service
- [x] Implement custom filters for request logging
- [x] Add rate limiting (100 req/min for regular, 1000 req/min for premium)
- [x] Set up CORS for web frontend

**âœ… å®ç°å®Œæˆè¯¦æƒ…**:

### ğŸŒ API Gateway æ¶æ„
- **ç«¯å£**: 8080
- **åŠŸèƒ½**: ç»Ÿä¸€å…¥å£ç‚¹ï¼Œæ™ºèƒ½è·¯ç”±ï¼Œæµé‡æ§åˆ¶
- **æ ¸å¿ƒç‰¹æ€§**: 
  - åŸºäºSpring Cloud Gatewayçš„å“åº”å¼æ¶æ„
  - ä¸EurekaæœåŠ¡å‘ç°æ·±åº¦é›†æˆ
  - Redisåˆ†å¸ƒå¼é™æµæ”¯æŒ
  - å…¨é“¾è·¯è¯·æ±‚è¿½è¸ªå’Œæ—¥å¿—è®°å½•
- **è®¿é—®åœ°å€**: http://localhost:8080

### ğŸ›£ï¸ æ™ºèƒ½è·¯ç”±é…ç½®
**è·¯ç”±è§„åˆ™**ï¼š
- **ğŸ‘¥ ç”¨æˆ·æœåŠ¡è·¯ç”±**: `/api/users/**` â†’ `lb://user-service`
- **ğŸ“¦ äº§å“æœåŠ¡è·¯ç”±**: `/api/products/**` â†’ `lb://product-service`  
- **ğŸ“‹ è®¢å•æœåŠ¡è·¯ç”±**: `/api/orders/**` â†’ `lb://order-service`
- **ğŸ¢ Eurekaä»£ç†**: `/eureka/**` â†’ `lb://eureka-server`

**è´Ÿè½½å‡è¡¡ç‰¹æ€§**ï¼š
- âœ… åŸºäºæœåŠ¡åçš„è‡ªåŠ¨å‘ç°å’Œè·¯ç”±
- âœ… å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ (Ribboné›†æˆ)
- âœ… å¥åº·æ£€æŸ¥å’Œæ•…éšœè½¬ç§»
- âœ… åŠ¨æ€è·¯ç”±æ›´æ–°

### âš¡ é«˜çº§é™æµç³»ç»Ÿ
**é™æµç­–ç•¥é…ç½®**ï¼š
- **ğŸ‘¥ ç”¨æˆ·æœåŠ¡**: 100 req/min (çªå‘å®¹é‡: 200)
- **ğŸ“¦ äº§å“æœåŠ¡**: 200 req/min (çªå‘å®¹é‡: 400)
- **ğŸ“‹ è®¢å•æœåŠ¡**: 50 req/min (çªå‘å®¹é‡: 100)

**ç”¨æˆ·åˆ†çº§é™æµ**ï¼š
- âœ… Regularç”¨æˆ·ï¼šåŸºç¡€é™æµç­–ç•¥
- âœ… Premiumç”¨æˆ·ï¼šç‹¬ç«‹é™æµé”®ï¼Œæ›´é«˜é…é¢
- âœ… åŸºäºIPçš„åˆ†å¸ƒå¼é™æµ (Redis)
- âœ… ä»¤ç‰Œæ¡¶ç®—æ³•å®ç°çªå‘æµé‡å¤„ç†

### ğŸ” è‡ªå®šä¹‰è¿‡æ»¤å™¨ç³»ç»Ÿ
**å…¨å±€è¿‡æ»¤å™¨**ï¼š
- âœ… **è¯·æ±‚æ—¥å¿—è¿‡æ»¤å™¨**: è®°å½•æ‰€æœ‰è¯·æ±‚/å“åº”ï¼Œæ€§èƒ½ç»Ÿè®¡
- âœ… **è®¤è¯è¿‡æ»¤å™¨**: æ¨¡æ‹Ÿç”¨æˆ·è®¤è¯å’Œç­‰çº§è¯†åˆ«
- âœ… **CORSè¿‡æ»¤å™¨**: è·¨åŸŸèµ„æºå…±äº«æ”¯æŒ

**è¿‡æ»¤å™¨ç‰¹æ€§**ï¼š
- âœ… Pre/Postå¤„ç†é˜¶æ®µæ”¯æŒ
- âœ… è‡ªå®šä¹‰è¯·æ±‚å¤´æ·»åŠ 
- âœ… å®¢æˆ·ç«¯IPè¯†åˆ«å’Œè®°å½•
- âœ… å“åº”æ—¶é—´ç»Ÿè®¡å’Œç›‘æ§

### ğŸŒ CORSè·¨åŸŸæ”¯æŒ
- âœ… **å…è®¸æ¥æº**: æ‰€æœ‰æ¥æº (å¼€å‘ç¯å¢ƒ)
- âœ… **æ”¯æŒæ–¹æ³•**: GET, POST, PUT, DELETE, OPTIONS
- âœ… **è¯·æ±‚å¤´æ”¯æŒ**: å…¨éƒ¨è‡ªå®šä¹‰å¤´éƒ¨
- âœ… **è®¤è¯æ”¯æŒ**: å…è®¸æºå¸¦è®¤è¯ä¿¡æ¯
- âœ… **é¢„æ£€ç¼“å­˜**: 3600ç§’ç¼“å­˜æ—¶é—´

### ğŸ“Š ç›‘æ§å’Œè¿ç»´
**ç›‘æ§ç«¯ç‚¹**ï¼š
- âœ… **å¥åº·æ£€æŸ¥**: `/actuator/health`
- âœ… **è·¯ç”±ä¿¡æ¯**: `/actuator/gateway/routes`
- âœ… **æŒ‡æ ‡ç›‘æ§**: `/actuator/metrics`
- âœ… **Gatewayè¿‡æ»¤å™¨**: `/actuator/gateway/filters`

**è¿ç»´ç‰¹æ€§**ï¼š
- âœ… è¯¦ç»†çš„è¯·æ±‚æ—¥å¿—è®°å½•
- âœ… æ€§èƒ½æŒ‡æ ‡æ”¶é›†
- âœ… Redisè¿æ¥çŠ¶æ€ç›‘æ§
- âœ… æœåŠ¡å‘ç°çŠ¶æ€æ£€æŸ¥

### ğŸ§ª æµ‹è¯•éªŒè¯
åˆ›å»ºäº†ç»¼åˆæµ‹è¯•è„šæœ¬ `test-api-gateway.sh`:
- âœ… Gatewayè·¯ç”±åŠŸèƒ½æµ‹è¯•
- âœ… è´Ÿè½½å‡è¡¡éªŒè¯
- âœ… é™æµæœºåˆ¶æµ‹è¯•
- âœ… CORSè·¨åŸŸæ”¯æŒæµ‹è¯•
- âœ… è‡ªå®šä¹‰è¿‡æ»¤å™¨éªŒè¯
- âœ… ç›‘æ§ç«¯ç‚¹æ£€æŸ¥
- âœ… APIè°ƒç”¨æ¼”ç¤º

**è¿è¡Œæµ‹è¯•**:
```bash
./test-api-gateway.sh
```

### ğŸ³ Dockerå®¹å™¨åŒ–
- âœ… GatewayæœåŠ¡DockeråŒ–
- âœ… Redisç¼“å­˜æœåŠ¡é›†æˆ
- âœ… å®Œæ•´çš„docker-composeé…ç½®
- âœ… æœåŠ¡ä¾èµ–å’Œå¥åº·æ£€æŸ¥
- âœ… å®¹å™¨ç½‘ç»œå’Œç«¯å£æ˜ å°„

### ğŸ“ˆ æ ¸å¿ƒæŒ‡æ ‡
- **è·¯ç”±æœåŠ¡æ•°**: 4ä¸ª (user, product, order, eureka)
- **é™æµç­–ç•¥**: 3ç§å·®å¼‚åŒ–é™æµé…ç½®
- **è¿‡æ»¤å™¨æ•°é‡**: 3ä¸ªæ ¸å¿ƒè¿‡æ»¤å™¨
- **ç›‘æ§ç«¯ç‚¹**: 4ä¸ªç®¡ç†ç«¯ç‚¹
- **CORSç­–ç•¥**: å®Œæ•´è·¨åŸŸæ”¯æŒ
- **å¹³å‡å“åº”æ—¶é—´**: < 50ms (Gatewayå±‚)

**Real-world Learning**: é€šè¿‡ç»Ÿä¸€Gatewayå…¥å£ï¼ŒæˆåŠŸå®ç°äº†é—ªè´­æ´»åŠ¨æœŸé—´çš„æµé‡ç®¡ç†ï¼ŒPremiumç”¨æˆ·äº«å—æ›´é«˜çš„APIé…é¢ï¼ŒåŒæ—¶ä¿æŠ¤åç«¯æœåŠ¡å…å—è¿‡è½½å†²å‡»

---

### **Week 4: Load Balancing & Client-Side Discovery**
**Spring Cloud Components**: Spring Cloud LoadBalancer, OpenFeign

**Business Scenario**: Distribute load across multiple instances during high traffic

**Hands-on Project**:
- Scale services horizontally
- Implement client-side load balancing
- Add Feign clients for clean service-to-service communication

**Specific Tasks**:
- [ ] Configure multiple instances of product-service (ports 8081, 8082, 8083)
- [ ] Implement custom load balancing strategy for product search
- [ ] Create Feign client in order-service to call product-service
- [ ] Add retry logic with exponential backoff
- [ ] Implement custom load balancer for vendor-specific routing

**Real-world Learning**: Handle vendor-specific product queries efficiently

---

### **Week 5: Configuration Management**
**Spring Cloud Components**: Spring Cloud Config Server, Config Client

**Business Scenario**: Manage configurations across environments (dev, staging, prod) and feature toggles

**Hands-on Project**:
- Centralize configuration management
- Implement feature toggles for new marketplace features
- Manage environment-specific settings

**Specific Tasks**:
- [ ] Set up Config Server with Git backend
- [ ] Move all application.yml to centralized config repo
- [ ] Implement feature toggles:
  - `feature.recommendations.enabled`
  - `feature.realtime-inventory.enabled`
  - `feature.multi-currency.enabled`
- [ ] Configure different payment gateways per environment
- [ ] Add configuration refresh without restart (@RefreshScope)

**Real-world Learning**: Deploy new features gradually with feature toggles

---

### **Week 6: Circuit Breaker & Resilience**
**Spring Cloud Components**: Spring Cloud Circuit Breaker (Resilience4j)

**Business Scenario**: Handle payment service outages and external API failures gracefully

**Hands-on Project**:
- Implement circuit breakers for external dependencies
- Add fallback mechanisms for critical user journeys
- Monitor and alert on circuit breaker state changes

**Specific Tasks**:
- [ ] Add circuit breaker to payment-service calls
- [ ] Implement fallback for product recommendations (show popular items)
- [ ] Configure bulkhead pattern for different operation types
- [ ] Add retry mechanism for inventory updates
- [ ] Implement timeout configurations for external APIs
- [ ] Create health indicators for circuit breaker states

**Real-world Learning**: Ensure checkout process works even when recommendation service fails

---

### **Week 7: Distributed Tracing & Monitoring**
**Spring Cloud Components**: Spring Cloud Sleuth, Micrometer

**Business Scenario**: Debug performance issues across the order fulfillment workflow

**Hands-on Project**:
- Implement distributed tracing
- Add custom metrics for business KPIs
- Set up monitoring dashboards

**Specific Tasks**:
- [ ] Add Spring Cloud Sleuth to all services
- [ ] Configure Zipkin for trace visualization
- [ ] Implement custom metrics:
  - Order completion rate
  - Average product search time
  - Payment processing duration
- [ ] Add correlation IDs for order tracking
- [ ] Set up Micrometer with Prometheus
- [ ] Create Grafana dashboards for business metrics

**Real-world Learning**: Track user journey from product search to order completion

---

### **Week 8: Security & Advanced Patterns**
**Spring Cloud Components**: Spring Cloud Security, Spring Cloud Stream

**Business Scenario**: Secure multi-tenant marketplace with real-time notifications

**Hands-on Project**:
- Implement OAuth2 security across services
- Add event-driven architecture for real-time updates
- Deploy to cloud environment

**Specific Tasks**:
- [ ] Set up OAuth2 authorization server
- [ ] Implement JWT token propagation between services
- [ ] Add role-based access (CUSTOMER, VENDOR, ADMIN)
- [ ] Implement Spring Cloud Stream for order events
- [ ] Create event-driven inventory updates
- [ ] Add message queues (RabbitMQ) for order processing
- [ ] Deploy entire system to AWS/Azure using Docker

**Real-world Learning**: Handle multi-vendor permissions and real-time inventory sync

---

## ğŸ› ï¸ Development Environment Setup

### **Required Tools**
```bash
# Core tools
java --version  # Java 17+
docker --version
docker-compose --version

# Optional but recommended
kubectl version  # For Kubernetes deployment
terraform --version  # For infrastructure as code
```

### **Project Structure**
```
shophub-microservices/
â”œâ”€â”€ eureka-server/
â”œâ”€â”€ api-gateway/
â”œâ”€â”€ config-server/
â”œâ”€â”€ user-service/
â”œâ”€â”€ product-service/
â”œâ”€â”€ order-service/
â”œâ”€â”€ payment-service/
â”œâ”€â”€ notification-service/
â”œâ”€â”€ vendor-service/
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ kubernetes/
```

---

## ğŸ“Š Success Metrics & Checkpoints

### **Weekly Checkpoints**
- **Week 2**: All services register with Eureka, can communicate
- **Week 3**: API Gateway routes all requests correctly
- **Week 4**: Load balancing works under simulated load
- **Week 5**: Configuration changes without code deployment
- **Week 6**: Circuit breakers activate during simulated failures
- **Week 7**: End-to-end request tracing visible in Zipkin
- **Week 8**: Full security implementation with multi-tenant support

### **Final Project Validation**
- [ ] Handle 1000 concurrent users
- [ ] 99.9% uptime during payment service restart
- [ ] Sub-200ms response time for product search
- [ ] Successful order processing during partial service failures
- [ ] Real-time inventory updates across all vendors

---

## ğŸ”— Key Resources

### **Official Documentation**
- [Spring Cloud Reference Guide](https://docs.spring.io/spring-cloud/docs/current/reference/html/)
- [Spring Cloud Examples](https://github.com/spring-cloud-samples)

### **Hands-on Labs**
- [Spring Cloud Workshop](https://github.com/spring-cloud/spring-cloud-workshop)
- [Microservices with Spring Boot](https://spring.io/guides/gs/centralized-configuration/)

### **Advanced Topics**
- Spring Cloud Kubernetes integration
- Service Mesh with Istio + Spring Cloud
- Multi-cloud deployment strategies

---

## ğŸ¯ Next Steps After Completion
1. **Advanced Patterns**: Event sourcing, CQRS with Spring Cloud
2. **Performance Optimization**: Caching strategies, database sharding
3. **Production Readiness**: Monitoring, alerting, chaos engineering
4. **Certification**: Spring Professional certification

---

*This framework emphasizes hands-on learning with a realistic business context that naturally requires all major Spring Cloud features. Each week builds upon the previous, creating a comprehensive e-commerce marketplace by the end.*